<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>网络延迟测试 | 爱玩电脑的winver的小破站</title>
    <!-- 爱玩电脑的winver开发的原创个人网页，代码受著作权法保护 -->
    <script>
        // 禁止调试代码
        try {
            if (/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
            } else {
                document.oncontextmenu = function (e) {
                    return false;
                };
                document.onkeydown = function (e) {
                    if (e.keyCode === 123) {
                        return false;
                    } else if ((e.ctrlKey) && (e.keyCode == 85)) {
                        return false;
                    } else if ((e.ctrlKey) && (e.shiftKey) && (e.keyCode == 73)) {
                        return false;
                    }
                };
                (() => {
                    function block() {
                        setInterval(() => {
                            if (window.outerHeight - window.innerHeight > 200 || window.outerWidth - window.innerWidth > 200) {
                                window.location.href = 'about:blank';
                            }
                            debugger;
                        }, 50);
                    }
                    try {
                        block();
                    } catch (err) {}
                })();
                window.oncopy = function () {
                    return false; // 阻止复制操作
                };

                (function () {
                    var i = 0;
                    var re = function () {
                        window.location.href = 'about:blank';
                    };
                    console.log(re);
                    re.toString = function () {
                        window.location.href = 'about:blank';
                    };
                })();
            }
        } catch (e) {}
    </script>
    <link rel="stylesheet" href="/css/Tool.css">
</head>

<div class="container">
    <h1>网络速度测试页面</h1>
    <input type="text" id="testUrl" class="" placeholder="输入要测试的URL">
    <input type="button" class="button-link" value="测试延迟" onclick="measure速度()">
    <p id="速度">网络速度： 未知</p>
    <div class="instructions">
        <strong>使用说明：</strong>
        <ol>
            <li>在上方的输入框中输入您想要测试的网站URL，最好是图片URL。</li>
            <li>点击“测试延迟”按钮。</li>
            <li>工具将显示延迟时间（以毫秒为单位），或者指示连接失败。</li>
        </ol>
        <a href="/" class="button-link">返回上一级</a>
    </div>
</div>

<script>
    // 用于测试网络速度的函数
    function measure速度() {
        // 定义测试的URL
        const testUrl = "https://www.baidu.com";
    
        // 获取开始时间
        const start = Date.now();
    
        // 使用Fetch API发起请求
        fetch(testUrl, { method: "HEAD" }) // 使用HEAD方法减少数据传输量
            .then(response => {
                if (!response.ok) {
                    throw new Error(`请求失败，状态码：${response.status}`);
                }
                // 获取结束时间
                const end = Date.now();
                // 计算延迟时间（单位：毫秒）
                const latency = end - start;
                // 显示结果
                document.getElementById('速度').innerText = `网络延迟：${latency} 毫秒`;
            })
            .catch(error => {
                // 捕获错误并显示
                console.error("测试失败：", error);
                document.getElementById('速度').innerText = `测试失败：${error.message}`;
            });
    }
    
    // 监听页面卸载事件
    window.addEventListener('beforeunload', function () {
        document.title = '(～￣▽￣)～ 欢迎下次光临';
    });

    // 监听页面可见性变化事件
    document.addEventListener('visibilitychange', function () {
        if (document.visibilityState === 'hidden') {
            document.title = '(＃°Д°) 唉，再看看嘛';
        } else if (document.visibilityState === 'visible') {
            document.title = 'ヾ(≧▽≦*)o 欢迎回来';
            setTimeout(function () {
                document.title = '网络延迟测试 | 爱玩电脑的winver的小破站'; // 最后恢复默认标题
            }, 3000); // 3秒后恢复默认标题
        }
    });
</script>

</body>
</html>
